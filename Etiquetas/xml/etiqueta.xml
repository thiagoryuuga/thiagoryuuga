<persistence table="logix.esm_item_serie">

	<column physical="COD_EMPRESA"
			logical ="COD_EMPRESA"
			key	="yes" />
	<column physical="COD_ITEM"
			logical ="COD_ITEM"
			key	="yes" />
	<column physical="NUM_SERIE"
			logical ="NUM_SERIE"
			key	="yes" />
	<column physical="DAT_IMPRESSAO"
			logical ="DAT_IMPRESSAO"
			key	="no" />
	<column physical="DAT_PRODUCAO"
			logical ="DAT_PRODUCAO"
			key	="no" />
	<column physical="DAT_FATURADO"
			logical ="DAT_FATURADO"
			key	="no" />
	<column physical="DAT_REPROCES"
			logical ="DAT_REPROCES"
			key	="no" />
	<column physical="QTD_REPROCES"
			logical ="QTD_REPROCES"
			key	="no" />
	<column physical="LIN_PRODUCAO"
			logical ="LIN_PRODUCAO"
			key	="no" />
	<column physical="IES_CONTADO"
			logical ="IES_CONTADO"
			key	="no" />
	<column physical="IES_SITUACAO"
			logical ="IES_SITUACAO"
			key	="no" />

	<query name="ObterItem">
	SELECT trim(DESCRIPTION) DEN_ITEM
	FROM XGEQ.GEQ_INV_TAG_ITENS@esm_etiqueta
	WHERE
		ORGANIZATION_ID = '106' AND
		SEGMENT1 = :COD_ITEM
	</query>
	
	<query name="ObterInformacaoItem">
	SELECT
    a.ORGANIZATION_ID EMPRESA,
    SEGMENT1 ITEM,
    TRIM(b.TAG_CODE) DEN_ETIQUETA,
    NVL(TEXT_MOD,' ') TEXTO_MODELO ,
    NVL(VALUE_MOD,' ') VALOR_MODELO,
    NVL(TEXT_CLASS,' ') TEXTO_CLASSE,
    NVL(VALUE_CLASS,' ') VALOR_CLASSE,
    NVL(TEXT_CATEGORY,' ') TEXTO_CATEGORIA,
    NVL(VALUE_CATEGORY,' ') VALOR_CATEGORIA,
    NVL(TEXT_FREQUENCY,' ') TEXTO_FREQUENCIA,
    NVL(VALUE_FREQUENCY,' ') VALOR_FREQUENCIA,
    CASE WHEN TEXT_VOLTAGE IS NULL THEN NVL(TENSAO, ' ')
    WHEN TEXT_VOLTAGE = '1' THEN TENSAO WHEN TEXT_VOLTAGE = '2' THEN TENSAO
    END TEXTO_TENSAO,
    CASE WHEN VALUE_VOLTAGE IS NULL THEN NVL(VALUE_TENSAO, ' ')
    WHEN VALUE_VOLTAGE = '127 Volts' THEN VALUE_TENSAO WHEN VALUE_VOLTAGE = '220 Volts' THEN VALUE_TENSAO
    END VALOR_TENSAO,
    NVL(TEXT_COLOR,' ') TEXTO_COR,
    NVL(VALUE_COLOR,' ') VALOR_COR,NVL (TEXT_INSULATION, ' ') TEXTO_GAS,NVL (VALUE_INSULATION, ' ') VALOR_GAS,
    NVL(TEXT_PRESSURE,' ') TEXTO_PRESSAO,
    NVL(VALUE_PRESSURE,' ') VALOR_PRESSAO,
    NVL(TEXT_POWER,' ') TEXTO_POTENCIA,
    NVL(VALUE_POWER,' ') VALOR_POTENCIA,
    NVL(TEXT_CURRENT,' ') TEXTO_CORRENTE,
    NVL(VALUE_CURRENT,' ') VALOR_CORRENTE,
    NVL(TEXT_HIGH,' ') TEXTO_ALTA_PRES,
    NVL(VALUE_HIGH,' ') VALOR_ALTA_PRES,
    NVL(TEXT_PSIG_LOW,' ') TEXTO_PSIG_BAIXA,
    NVL(VALUE_PSIG_LOW,' ') VALOR_PSIG_BAIXA,
    NVL(VOLUME_TOTAL,' ') TEXTO_VOLUME,
    NVL(VALOR_VOLUME_TOTAL,' ') VALOR_VOLUME,
    NVL (CLASS_ISOL, ' ') TEXTO_ISOLAMENTO,
    NVL (VALUE_CLASS_ISOL, ' ') VALOR_ISOLAMENTO,
    NVL(TEXT_STARS,' ') TEXTO_ESTRELAS,
    NVL(VALUE_STARS,' ') VALOR_ESTRELAS,
    NVL(TEXT_VOLREF,' ') TEXTO_VOLREF,
    NVL(VALUE_VOLREF,' ') VALOR_VOLREF,
    NVL(TEXT_VALCON,' ') TEXTO_VOLCON,
    NVL(VALUE_VALCON,' ') VALOR_VOLCON,
    NVL(TEXT_ELECTRIC_POWER,' ') TEXTO_POTEN_ELET,
    NVL(VALUE_ELECTRIC_POWER,' ') VALOR_POTEN_ELET,
    NVL(TEXT_TRACK_POWER,' ') TEXTO_FAIXA_TENSAO,
    NVL(VALUE_TRACK_POWER,' ') VALOR_FAIXA_TENSAO,NVL(TEXT_GAS,' ') TEXTO_CARGA_GAS,NVL(VALUE_GAS,' ') VALOR_CARGA_GAS,
    NVL(TEXT_NUM_SERIAL,' ') TEXTO_NUM_SERIE,
    NVL(HEADER_DESC,' ') CABECALHO,
    NVL(COLUMN1,' ') CABECALHO_1,
    NVL(COLUMN2,' ') CABECALHO_2,
    NVL(COLUMN3,' ') CABECALHO_3,
    NVL(COLUMN4,' ') CABECALHO_4,
    NVL(NUM_TAG_COMPLETION,0) NUM_ETIQ_COMPLETA,
    NVL(NUM_TAG_PROD,0) NUM_ETIQ_PRODUTO,
    NVL(NUM_TAG_MODEL,0) NUM_ETIQ_MODELO,
    trim(NVL(COD_EAN13,' ')) CODIGO_EAN13,
    NVL(WIDTH,0) LARGURA,
    NVL(LENGTH,0) COMPRIMENTO,
    NVL(THICKNESS,0) ESPESSURA,
    NVL(DEN_MODEL_COLOR,0) MODELO_COR,
    NVL(TEXT_VOLTAGE,0) VOLTAGEM,
    NVL(PART_FIXED_BAR,' ') PARTE_FIXA_BARRA,
    NVL(ULT_VALUE_BAR,0) ULT_VALOR_BARRA,
    NVL(ULT_NUM_SERIAL,0) ULT_NUM_SERIE,
    NVL(ULT_YEAR_SERIAL,0) ULT_ANO_SERIE ,
    NVL(ULT_SEM_SERIAL,0) ULT_SEM_SERIE,
    e.COD_LEGADO COD_LEGADO
    FROM 
        XGEQ.GEQ_INV_TAG_ITENS@esm_etiqueta a, 
        XGEQ.GEQ_INV_TAG_MODEL@esm_etiqueta b, 
        XGEQ.GEQ_INV_TAG_MODEL_COLOR@esm_etiqueta c, 
        XGEQ.GEQ_INV_TAG_STANDARD@esm_etiqueta d,
        CONQUISTAR.GEQ_DE_PARA_LGX_EBS e
    WHERE a.ORGANIZATION_ID = :COD_EMPRESA
    AND b.ORGANIZATION_ID = a.ORGANIZATION_ID
    AND a.MODEL_COLOR_ID = c.MODEL_COLOR_ID(+)
    AND a.STANDARD_ID = d.STANDARD_ID
    AND b.MODEL_ID = a.MODEL_ID
    AND a.SEGMENT1 = e.COD_EBS
    AND a.SEGMENT1 = :COD_ITEM	
	</query>
	
	<query name="AtualizarNumSerie">
	UPDATE XGEQ.GEQ_INV_TAG_MODEL@esm_etiqueta
	SET ULT_NUM_SERIAL = ULT_NUM_SERIAL + :QTD_ETIQ
	WHERE ORGANIZATION_ID = :COD_EMPRESA 
	AND TRIM(TAG_CODE) = TRIM(:DEN_ETIQUETA)
	</query>

	<query name="InserirItemSerie">
	INSERT INTO LOGIX.ESM_ITEM_SERIE(COD_EMPRESA,COD_ITEM,NUM_SERIE,DAT_IMPRESSAO,IES_CONTADO)
	VALUES (:COD_EMPRESA,:COD_ITEM,:NUM_SERIE,SYSDATE,'N')
	</query>

	<query name="ValidaSerie">
	select count(*) TOTAL from LOGIX.ESM_ITEM_SERIE
	where cod_empresa = :COD_EMPRESA and
	cod_item =   :COD_ITEM and
	num_serie =  :NUM_SERIE
	</query>
	
	<query name="ObterModelo">
	SELECT DEN_MODEL_COLOR den_modelo_cor
	FROM XGEQ.GEQ_INV_TAG_MODEL_COLOR@esm_etiqueta 
	WHERE MODEL_COLOR_ID   = :COD_MODELO
	</query>

	<query name="ObterCodItem">
	SELECT SEGMENT1 item
	FROM XGEQ.GEQ_INV_TAG_ITENS@esm_etiqueta
	WHERE ORGANIZATION_ID = :COD_EMPRESA
	AND MODEL_COLOR_ID = :COD_MODELO
	AND TEXT_VOLTAGE = :COD_VOLTAGEM
	</query>

	<query name="ObterCargaGas">
	SELECT valor_gas
    FROM logix.man_compressor_568
    WHERE compressor     = :COMPRESSOR
    AND cod_item         = :COD_ITEM
	</query>

</persistence>
